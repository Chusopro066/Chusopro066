<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <title>1v1 LOL - topVAZ #3</title>
    <meta name="robots" content="noindex, nofollow">
    <link rel="icon" type="image/png" href="favicon.png?v2">
    <meta property="og:title" content="1v1.LOL">
    <meta property="og:type" content="website">
    <meta property="og:description" content="Discover 1v1, the online building simulator &amp; third person shooting game. Battle royale, build fight, box fight, zone wars and more game modes to enjoy!">
    <link rel="stylesheet" href="css/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="Discover 1v1, the online building simulator &amp; third person shooting game. Battle royale, build fight, box fight, zone wars and more game modes to enjoy!">
</head>
<body>
    <!-- Aquí se muestra el botón para abrir el pop-up -->
    <button id="openGameButton">Abrir Juego</button>

    <script>
        // Función para abrir el juego en un pop-up
        function openGamePopup() {
            // Crea una ventana emergente con el tamaño adecuado
            var popupWindow = window.open('', 'gameWindow', 'width=800,height=600,resizable=yes,scrollbars=yes');

            // Si la ventana emergente no se abre, muestra un error
            if (!popupWindow) {
                alert("¡No se pudo abrir el pop-up! Asegúrate de permitir ventanas emergentes.");
                return;
            }

            // Ahora, vamos a escribir el contenido HTML dentro de la ventana emergente
            var popupDocument = popupWindow.document;

            // Escribimos el contenido HTML
            popupDocument.open();
            popupDocument.write(`
                <!DOCTYPE html>
                <html lang="es">
                <head>
                    <meta charset="utf-8">
                    <title>1v1 LOL - topVAZ #3</title>
                    <link rel="icon" type="image/png" href="favicon.png?v2">
                    <meta property="og:title" content="1v1.LOL">
                    <meta property="og:type" content="website">
                    <meta property="og:description" content="Discover 1v1, the online building simulator &amp; third person shooting game. Battle royale, build fight, box fight, zone wars and more game modes to enjoy!">
                    <link rel="stylesheet" href="css/style.css">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
                    <meta name="description" content="Discover 1v1, the online building simulator &amp; third person shooting game. Battle royale, build fight, box fight, zone wars and more game modes to enjoy!">
                </head>
                <body>
                    <!-- Contenedor para el juego -->
                    <div id="gameContainer" style="padding: 0px; margin: 0px; border: 0px; position: relative; background: rgb(0, 0, 0);">
                        <canvas id="canvas" width="507" height="297" style="width: 100%; height: 100%; cursor: default;"></canvas>
                    </div>
                    <div id="loader" style="display: none;">
                        <img class="logo" src="logo.png">
                        <div class="spinner" style="display: none;"></div>
                        <div class="progress" style="display: block;">
                            <div class="full" style="transform: scaleX(1);"></div>
                        </div>
                    </div>

                    <!-- Carga de scripts -->
                    <script src="js/UnityLoader.js"></script>
                    <script>
                        var gameJsonUrl = "WebGL.json"; // La URL del archivo JSON para el juego Unity

                        // Carga del juego Unity
                        var gameInstance = UnityLoader.instantiate("gameContainer", gameJsonUrl, { onProgress: UnityProgress });

                        function UnityProgress(gameInstance, progress) {
                            if (!gameInstance.Module) {
                                return;
                            }
                            const loader = document.querySelector("#loader");
                            if (!gameInstance.progress) {
                                const progress = document.querySelector("#loader .progress");
                                progress.style.display = "block";
                                gameInstance.progress = progress.querySelector(".full");
                                loader.querySelector(".spinner").style.display = "none";
                            }
                            gameInstance.progress.style.transform = \`scaleX(\${progress})\`;
                            if (progress === 1 && !gameInstance.removeTimeout) {
                                loader.style.display = "none";
                            }
                        }

                        // Bloquear teclas para evitar problemas
                        document.onkeydown = function (e) {
                            if (e.altKey || e.ctrlKey || e.key == "F1" || e.key == "F2" || e.key == "F3" || e.key == "F4") {
                                e.preventDefault();
                            }
                        };

                        document.onmouseup = function (e) {
                            e.preventDefault();
                        };
                    </script>
                </body>
                </html>
            `);
            // Cierra el documento en la ventana emergente para que se procese
            popupDocument.close();
        }

        // Asigna la función de abrir el juego al botón
        document.getElementById('openGameButton').addEventListener('click', openGamePopup);
    </script>
</body>
</html>
